# [PackageDev] target_format: plist, ext: tmLanguage
name: Qlik expression files (InfoVizion format)
fileTypes: [qlikview-vars]

scopeName: source.qlik-expressions

uuid: 6b77dc03-7003-41f4-a9f6-287849f88d5f

patterns:

- include: '#expressionName'

- include: '#section'

- include: '#yamlNewDocument'

- include: '#expression'

# - include: '#expressionWithEqualSign'

# - include: '#expressionWithoutEqualSign'

# - include: '#simpleField'

# - include: '#def'

- include: '#tag'

repository:
  # def:
  #   patterns:
  #   - name: meta.expression.qlik-expressions
  #     begin: ^#define\s+
  #     beginCaptures:
  #       '0': {name: support.constant.qlik-expressions}
  #     end: ^(?=\S)
  #     endCaptures:
  #       '0': {name: support.constant.qlik-expressions}
  #     patterns:
  #     - include: source.qvs

  expression:
    patterns:
    - name: meta.expression.qlik-expressions
      begin: '^(definition):'
      beginCaptures:
        '0': {name: entity.name.tag.qlik-expressions}
      end: ^(?=\S)
      endCaptures:
        '0': {name: support.constant.qlik-expressions}
      patterns:
      - include: source.qvs

  # expressionWithEqualSign:
  #   patterns:
  #   - name: meta.expression.qlik-expressions
  #     begin: ^(label|comment):\s*(?==)
  #     beginCaptures:
  #       '0': {name: support.constant.qlik-expressions}
  #     end: ^(?=\S)
  #     endCaptures:
  #       '0': {name: support.constant.qlik-expressions}
  #     patterns:
  #     - include: source.qvs

  # expressionWithoutEqualSign:
  #   patterns:
  #   - name: string.single.quoted.qlik-expressions
  #     begin: '^(label|comment):'
  #     beginCaptures:
  #       '0': {name: support.constant.qlik-expressions}
  #     end: ^(?=\S)
  #     endCaptures:
  #       '0': {name: support.constant.qlik-expressions}
  expressionName:
    patterns:
    - match: ^\s*(set|let):\s*(\w[\w_.]+)\s*$
      captures:
        '1': {name: entity.name.tag.qlik-expressions}
        '2': {name: support.variable.qlik-expressions entity.name.type.expression.qlik-expressions}
  tag:
    patterns:
    - name: meta.tag.qlik-expressions
      match: (label|family|type|selectorLabel|format):(.*)
      captures:
        '1': {name: entity.name.tag.qlik-expressions}
        '2': {name: string.unquoted.plain.out}

  # simpleField:
  #   patterns:
  #   - name: support.constant.qlik-expressions
  #     match: (^(\s)*(tag|description):(\s)*)

  yamlNewDocument:
    patterns:
    - name: keyword.control.qlik-expressions
      match: ^---$
  section:
    patterns:
    - match: ^(#SECTION )\s*(.+)$
      captures:
        '1': {name: comment.line.double-dash.qlik-expressions}
        '2': {name: support.variable.qlik-expressions meta.name.section.qlik-expressions}
